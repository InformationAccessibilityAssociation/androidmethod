<!DOCTYPE html>

<html lang="zh-CN">
<head>
<title>让ListView的item的每一个控件都有焦点</title>
<link rel="stylesheet" href="../style.css" />
<meta charset="utf-8">
<script type="text/javascript" src="js/jquery.js"></script>
<script type="text/javascript" src="js/jquery.zclip.min.js"></script>
<script type="text/javascript">
$(function(){ 
    $('#copy_input1').zclip({ 
        path: 'js/ZeroClipboard.swf', 
        copy: function(){//复制内容 
            return $('#code1').val(); 
        }, 
        afterCopy: function(){//复制成功 
            $("<span id='msg'/>").insertAfter($('#copy_input')).text('复制成功'); 
        } 
    }); 
}); 
$(function(){ 
    $('#copy_input2').zclip({ 
        path: 'js/ZeroClipboard.swf', 
        copy: function(){//复制内容 
            return $('#code2').val(); 
        }, 
        afterCopy: function(){//复制成功 
            $("<span id='msg'/>").insertAfter($('#copy_input')).text('复制成功'); 
        } 
    }); 
}); 
</script>
</head>
<body>
<div class="wrap">
<!-- header begin -->
<div class="header">
    <div ><a href="http://www.siaa.org.cn/"><img src="../logo.png" alt="信息无障碍研究会"  class="logo"/></a></div>
    <!-- nav bar begin -->
    <div class="nav-bar">
        <!-- nav menu begin -->
        <ul>
            <li><a href="../index.html">首页</a></li>
            <li><a href="../index.html">返回</a></li>
        </ul>
        <!-- nav menu end -->
    </div>
    <!-- nav bar end -->
</div>
<!-- header end -->

<!-- body begin -->
<div class="body">
    <h3>让ListView的item的每一个控件都有焦点____20160428</h3>
    <hr />
    <div>
        <h4>【问题描述】</h4>
        <hr />
        <p>ListView的item如果是自定义的布局文件，如果没有给item内部的控件添加焦点，在开启屏幕阅读器的情况下用户浏览ListView的item，是一个item一个焦点，用户无法浏览到item中的每一个控件。这种情况当item中有Button、CheckBox等可以操作的控件的时候会导致用户无法操作每一个item中的Button、CheckBox等可操作的控件。</p><!--问题说明-->
    </div>
    <div>
        <h4>【问题代码】</h4>
        <hr />
        <p>下面的代码是ListView的item的布局文件，MainActivity.xml和MainActivity.Java代码请参看“附1”。</p>
        <textarea rows="14" cols="120" aria-label="问题代码" id="code1">
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"
	android:orientation="horizontal"
	android:layout_width="match_parent"
	android:layout_height="wrap_content"
	android:id="@+id/layout">
	<ImageView android:id="@+id/header"
		android:layout_width="wrap_content"
		android:layout_height="wrap_content" 
		android:paddingLeft="10dp"/>
		<LinearLayout
			android:orientation="vertical"
			android:layout_width="match_parent"
			android:layout_height="wrap_content">
		<TextView android:id="@+id/name"
			android:layout_width="wrap_content" 
			android:layout_height="wrap_content"
			android:textSize="20dp"
			android:textColor="#f0f"
			android:paddingLeft="10dp"/>
		<TextView android:id="@+id/desc"
			android:layout_width="wrap_content" 
			android:layout_height="wrap_content"
			android:textSize="14dp"
			android:paddingLeft="10dp"/>
		</LinearLayout>
</LinearLayout>
        </textarea><br/>
        <a href="#" id="copy_input1" class="copy">复制内容</a> 
    </div>
    <div>
        <h4>【问题解决方案描述】</h4>
        <hr />
        <p>给ListView的item布局文件中的每一个控件根据实际情况添加焦点，添加焦点的方法是Android:focusable=”true”、android:focusableInTouchMode=”true”。给item中的控件添加了焦点之后必须给item的最外层的布局添加android:descendantFocuability=”blocksDescendants”属性，如果没有添加此属性会导致ListView的item点击无效。</p>
    </div>
    <div>
        <h4>【解决方案】</h4>
        <hr />
        <textarea rows="14" cols="120" aria-label="解决方案代码" id="code2">
<!—这是ListView的item的布局文件->
<?xml version="1.0" encoding="utf-8"?>
<LinearLayout 	xmlns:android="http://schemas.android.com/apk/res/android"
	android:orientation="horizontal"
	android:layout_width="match_parent"
	android:layout_height="wrap_content"
	android:id="@+id/layout"
	<!--下面这行代码解决当item的控件获得焦点item无法点击的问题-->
	android:descendantFocusability="blocksDescendants"
	<ImageView android:id="@+id/header"
		android:layout_width="wrap_content"
		android:layout_height="wrap_content" 
		android:paddingLeft="10dp"
		android:focusable="true"
		android:focusableInTouchMode="true"
		<!—给ImageButton添加描述文本->
		Android:contentDescription=”头像”/>
	<LinearLayout
		android:orientation="vertical"
		android:layout_width="match_parent"
		android:layout_height="wrap_content">

		<TextView android:id="@+id/name"
			android:layout_width="wrap_content" 
			android:layout_height="wrap_content"
			android:textSize="20dp"
			android:textColor="#f0f"
			android:paddingLeft="10dp"
			android:focusable="true"
			android:focusableInTouchMode="true"/>
		<TextView android:id="@+id/desc"
			android:layout_width="wrap_content" 
			android:layout_height="wrap_content"
			android:textSize="14dp"
			android:paddingLeft="10dp"
			android:focusable="true"
			android:focusableInTouchMode="true"/>
		</LinearLayout>
</LinearLayout>
        </textarea><br/>
        <a href="#" id="copy_input2" class="copy">复制内容</a> 
    </div>
    <div>
        <h4>【前后效果图对比】</h4>
        <hr />
        <table>
            <tr>
                <td><img src="../images/14-1.png" class="litu" alt="" aria-labelledby="img1_label"/></td><td><img src="../images/14-2.png" class="litu" alt="" aria-labelledby="img2_label"/></td>
            </tr>
            <tr>
                <td id="img1_label">
优化前，聚焦朗读“头像 弄玉 一个擅长音乐的女孩”；点击时朗读“弄玉被单击了”;</td><td id="img2_label">优化后，头像焦点聚焦点击时，分别朗读“头像”、“弄玉被单击了”；
弄玉焦点聚焦点击时，分别朗读“弄玉”、“弄玉被单击了”
一个擅长音乐的女孩焦点聚焦点击时，分别朗读“一个擅长音乐的女孩”“ 弄玉被单击了”
优化前，聚焦朗读“头像 弄玉 一个擅长音乐的女孩”； 点击时朗读“弄玉被单击了”</td>
            </tr>
        </table>
    </div>
    <div>
        <h4>【扩展】</h4>
        <hr />
        <p></p>
		<a href="14fujian.html">附件1</a>
    </div>
    <div>
        <h4>【更多】</h4>
        <hr />
        <ol></ol>
    </div>
</div>
<!-- body end -->

<!-- footer begin -->
<div class="footer">
</div>
<!-- footer end -->
</div>
<!-- wrap end -->
</body>
</html>
